define(["template","dialog","report/edit/component-box/main-model","report/edit/component-box/main-template"],function(a,b,c,d){return Backbone.View.extend({events:{"change #component-group-selector":"showCompByGroup","click .j-component-box-fold":"fold"},initialize:function(a){this.model=new c({id:this.id}),this.canvasView=a.canvasView,this.$el.append(d.render(this.model.config)),this.showCompByGroup(),this.initDrag()},showCompByGroup:function(){var a=this.$el.find(".j-con-component-box");a.find(".j-con-component").hide();var b=""+a.find("#component-group-selector").val(),c=".j-con-component[data-group-id="+b+"]";a.find(c).show(),this.currentGroupId=b},initDrag:function(){var a=this,b=".j-report",c=0,d=a.$el.find(b);$(".j-con-component .j-component-item",this.$el).draggable({appendTo:b,helper:"clone",scroll:!0,scrollSensitivity:100,opacity:1,drag:function(){},start:function(b,e){var f=e.helper.attr("data-component-type"),g=a.model.getComponentData(f);c=d.scrollTop(),e.helper.html("临时展示").css({width:"100px",height:"100px",cursor:"move",background:"#ffffff"}).addClass("active shell-component"),e.helper.attr("data-default-width",g.defaultWidth),e.helper.attr("data-default-height",g.defaultHeight),e.helper.attr("data-sort-startScrrolTop",e.helper.parent().scrollTop()),$(".j-report").addClass("active")}})},fold:function(a){var b=$(a.target),c=b.parents(".j-con-component-box"),d=25;c.width()>d?(c.width(d).height(d),b.html("+"),c.find("select").hide()):(c.width(160).height("auto"),b.html("-"),c.find("select").show())},destroy:function(){this.model.clear({silent:!0}),this.stopListening(),this.$el.unbind().empty()}})});